"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.hydrateReply = void 0;
const format_js_1 = require("./format.js");
const buildReplyWithParseMode = (parseMode, ctx) => {
    return (...args) => {
        const [text, payload, ...rest] = args;
        return ctx.reply(text, { ...payload, parse_mode: parseMode }, ...rest);
    };
};
const middleware = async (ctx, next) => {
    ctx.replyFmt = (stringLike, ...args) => {
        const [payload, ...rest] = args;
        const entities = stringLike instanceof format_js_1.FormattedString
            ? { entities: stringLike.entities }
            : undefined;
        return ctx.reply(stringLike.toString(), { ...payload, ...entities }, ...rest);
    };
    ctx.replyWithHTML = buildReplyWithParseMode("HTML", ctx);
    ctx.replyWithMarkdown = buildReplyWithParseMode("MarkdownV2", ctx);
    ctx.replyWithMarkdownV1 = buildReplyWithParseMode("Markdown", ctx);
    ctx.replyWithMarkdownV2 = buildReplyWithParseMode("MarkdownV2", ctx);
    return next();
};
exports.hydrateReply = middleware;
